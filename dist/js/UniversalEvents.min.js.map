{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/UniversalEvents.js","UniversalEvents.min.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","UniversalEvents","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","shimSetImmediate","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","setImmediate","setTimeout","validEvents","Set","_eventListeners","eventName","handler","has","push","addEventListener","handlers","index","indexOf","splice","data","runHandler","boundHandler","boundData","apply","bind","undefined","raiseEvent","successEventName","failureEventName","Promise","resolve","reject","successHandler","val","removeEventListener","failureHandler","err"],"mappings":"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","file":"UniversalEvents.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nvar shimSetImmediate;\nif (typeof setImmediate === 'function') {\n    shimSetImmediate = function (f) {\n        return setImmediate(f);\n    };\n} else {\n    shimSetImmediate = function(f) {\n        return setTimeout(f, 0);\n    };\n}\n\nexport default class UniversalEvents {\n\n    constructor(validEvents) {\n        if (!validEvents) {\n            this.validEvents = null;\n        } else if (typeof validEvents === 'string') {\n            throw new Error('Use of a string is probably a typo, should be Set or Array, or other iterable');\n        } else {\n            this.validEvents = new Set(validEvents);\n        }\n\n        this._eventListeners = {};\n    }\n\n    addEventListener(eventName, handler) {\n        if (this.validEvents && !this.validEvents.has(eventName)) {\n            throw new Error('Unknown event name: ' + eventName)\n        }\n\n        if (!this._eventListeners[eventName]) {\n            this._eventListeners[eventName] = [];\n        }\n\n        this._eventListeners[eventName].push(handler);\n\n        return this;\n    }\n\n    on(eventName, handler) {\n        return this.addEventListener(eventName, handler);\n    }\n\n    removeEventListener(eventName, handler) {\n        if (this.validEvents && !this.validEvents.has(eventName)) {\n            throw new Error('Unknown event name: ' + eventName)\n        }\n\n        var handlers = this._eventListeners[eventName];\n\n        if (handlers) {\n            var index = handlers.indexOf(handler);\n            handlers.splice(index, 1);\n        }\n\n        return this;\n    }\n\n    raiseEvent(eventName, data) {\n        if (this.validEvents && !this.validEvents.has(eventName)) {\n            throw new Error('Unknown event name: ' + eventName)\n        }\n\n        var handlers = this._eventListeners[eventName];\n\n        if (handlers) {\n            for (var i = 0; i < handlers.length; i++) {\n                var handler = handlers[i];\n\n                var runHandler = function (boundHandler, boundData) {\n                    boundHandler.apply(this, [boundData]);\n                }.bind(undefined, handler, data);\n\n                shimSetImmediate(runHandler);\n            }\n            return true;\n        }\n        return false;\n    }\n\n    emit(eventName, data) {\n        return this.raiseEvent(eventName, data);\n    }\n\n    await(successEventName, failureEventName) {\n        var self = this;\n\n        if (this.validEvents) {\n            if (!this.validEvents.has(successEventName)) {\n                throw new Error('Unknown event name: ' + successEventName)\n            }\n            if (!this.validEvents.has(failureEventName)) {\n                throw new Error('Unknown event name: ' + failureEventName)\n            }\n            if (successEventName === failureEventName) {\n                throw new Error('Identical event name for success and failure: ' + failureEventName)\n            }\n        }\n\n        return new Promise(\n            function(resolve, reject) {\n                function successHandler(val) {\n                    self.removeEventListener(successEventName, successHandler);\n                    self.removeEventListener(failureEventName, failureHandler);\n\n                    resolve(val);\n                }\n\n                function failureHandler(err) {\n                    self.removeEventListener(successEventName, successHandler);\n                    self.removeEventListener(failureEventName, failureHandler);\n\n                    reject(err);\n                }\n\n                self.addEventListener(successEventName, successHandler);\n                self.addEventListener(failureEventName, failureHandler);\n            });\n    }\n}\n",null],"sourceRoot":"/source/"}